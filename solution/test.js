/*!
 * Hermes.js
 * http://tcorral.github.com/Hermes.js/
 */
(function(h){var g=null,a=null,p=null,f=null,n=null,o=null,e=null,u=null,k=null,r=null,q=null,j=null,d=null,t=5000;function b(v){return Object.prototype.toString.call(v)==="[object Function]"}function c(w,v){return w&&w[v]}function m(v){return v<1?"":new Array(v+1).join(" ")}function l(w){var v=w.indexOf(":");return w.substr(0,v)}function i(v){var w=l(v);return v.replace(w+":","")}u=function(v){this.sName="[object Appender]";this.oLayout=v||null};u.prototype.setName=function(v){this.sName=v;return this};u.prototype.setLayout=function(v){this.oLayout=v;return this};u.prototype.toString=function(){return this.sName};u.prototype.log=function(v){throw new Error("This method must be overwritten!")};u.prototype.clear=function(){throw new Error("This method must be overwritten!")};r=function(){};r.prototype.formatError=function(v){throw new Error("This method must be overwritten!")};q=function(){r.apply(this)};q.prototype=new r();q.prototype.formatError=function(w){var v="";if(w instanceof e){v="Error level: "+w.oLevel.toString()+", Time: "+w.getFormattedDate();if(w.sCategory!==null){v+=", Category: "+w.sCategory}if(w.sMessage!==null){v+=", Message: "+w.sMessage}if(w.sFilenameUrl!==null){v+=", FilenameUrl: "+w.sFilenameUrl}if(w.nLineNumber!==null){v+=", LineNumber: "+w.nLineNumber}v+="."}return v};k=function(v){u.apply(this,arguments);this.sName="[object ConsoleAppender]";this.oLayout=new q()};k.prototype=new u();k.prototype.log=function(v){if(c(h.console,"log")){h.console.log(this.oLayout.formatError(v))}};k.prototype.clear=function(){if(c(h.console,"clear")){h.console.clear()}};g=function(w,v,x){this.oAppenders={};this.aErrors=[];this.oLevel=w||j.ALL;this.nTimeLastSent=this.now();this.nImmediate=v||g.DEFERRED;this.nTimeout=x||t};g.DEFERRED=0;g.IMMEDIATE=1;g.prototype.deferLog=function(){this.nImmediate=g.DEFERRED;return this};g.prototype.immediateLog=function(){this.nImmediate=g.IMMEDIATE;return this};g.prototype.now=function(){return +new Date()};g.prototype.setLevel=function(v){if(v instanceof j){this.oLevel=v}return this};g.prototype.addAppender=function(v){if(v instanceof u){this.oAppenders[v.toString()]=v}return this};g.prototype.removeAppender=function(v){delete this.oAppenders[v.toString()];return this};g.prototype.setAppenders=function(v){var w=0,y=v.length,x=null;for(;w<y;){x=v[w];this.addAppender(x);w=w+1}try{return this}finally{w=y=x=null}};g.prototype.isSameLevel=function(v){if(this.oLevel.valueOf()===j.nALL){return true}else{if(this.oLevel.valueOf()===j.OFF){return false}else{return this.oLevel.valueOf()===v.oLevel.valueOf()}}};g.prototype.sendMessage=function(x,w){if(typeof x[w]==="undefined"){return}var v=0,y=this.aErrors.length,z=null;for(;v<y;){z=this.aErrors[v];if(this.isSameLevel(z)){x[w](z)}v=v+1}this.nTimeLastSent=this.now()};g.prototype.isImmediate=function(){return this.nImmediate===g.IMMEDIATE};g.prototype.isTimeToSent=function(){return this.now()>=this.nextTimeToSent()};g.prototype.notifyAppenders=function(v){var x="",w=null;v=v.toLowerCase();if(this.isImmediate()){for(x in this.oAppenders){if(this.oAppenders.hasOwnProperty(x)){w=this.oAppenders[x];this.sendMessage(w,v)}}this.resetErrors()}else{if(this.isTimeToSent()){for(x in this.oAppenders){if(this.oAppenders.hasOwnProperty(x)){w=this.oAppenders[x];this.sendMessage(w,v)}}this.resetErrors()}}return this};g.prototype.addError=function(v){if(v instanceof e){this.aErrors.push(v);this.notifyAppenders("log")}return this};g.prototype.resetErrors=function(){this.aErrors=[]};g.prototype.nextTimeToSent=function(){return this.nTimeLastSent+this.nTimeout};g.prototype.forceLog=function(){this.immediateLog();this.log();this.deferLog();return this};g.prototype.log=function(){this.notifyAppenders("log")};g.prototype.clear=function(){this.notifyAppenders("clear")};d=function(v){this.sFormat=v||d.DEFAULT};d.DEFAULT="yyyy-MM-dd  hh:mm:ss TZ";d.prototype.setDefaultFormat=function(v){this.sFormat=v||d.DEFAULT;return this};d.prototype.formatDate=function(F){var v=this.addZero(F.getDate()),x=this.addZero(F.getMonth()+1),E=F.getFullYear(),y=String(E).substring(3,4),B=this.sFormat.indexOf("yyyy")>-1?E:y,A=this.addZero(F.getHours()),z=this.addZero(F.getMinutes()),D=this.addZero(F.getSeconds()),w=this.getTimeZoneOffset(F),C=this.sFormat.replace(/dd/g,v).replace(/MM/g,x).replace(/y{1,4}/g,B);C=C.replace(/hh/g,A).replace(/mm/g,z).replace(/ss/g,D);C=C.replace(/TZ/g,w);try{return C}finally{v=x=E=y=B=A=z=D=w=C=null}};d.prototype.addZero=function(v){return((v<10)?"0":"")+v};d.prototype.getTimeZoneOffset=function(w){var y=Math.abs(w.getTimezoneOffset()),x=this.addZero(Math.floor(y/60)),v=this.addZero((y%60));try{return w.getTimezoneOffset()<0?"+"+x+":"+v:"-"+x+":"+v}finally{y=x=v=null}};e=function(z,y,x,w,A,v){this.oLevel=z||j.ALL;this.sCategory=y||"GENERAL";this.sMessage=x||"Error Undefined";this.dInitialize=new Date();this.oDateFormatter=new d().setDefaultFormat(v);this.sFilenameUrl=w||null;this.nLineNumber=A||null};e.prototype.setFilenameUrl=function(v){this.sFilenameUrl=v;return this};e.prototype.setLineNumber=function(v){this.nLineNumber=v;return this};e.prototype.setCategory=function(v){this.sCategory=v;return this};e.prototype.setLevel=function(v){if(v instanceof j){this.oLevel=v}return this};e.prototype.setMessage=function(v){this.sMessage=v;return this};e.prototype.setDateFormat=function(v){this.sDateFormat=v;return this};e.prototype.getFormattedDate=function(){return this.oDateFormatter.formatDate(this.dInitialize)};j=function(w,v){this.nLevel=w;this.sLevel=v};j.prototype.getLevel=function(v){var w=j[v];if(typeof w!=="undefined"){return w}w=null};j.prototype.toString=function(){return this.sLevel};j.prototype.valueOf=function(){return this.nLevel};j.nOFF=Number.MAX_VALUE;j.nFATAL=50000;j.nERROR=40000;j.nWARNING=30000;j.nINFO=20000;j.nDEBUG=10000;j.nTRACE=5000;j.nALL=Number.MIN_VALUE;j.OFF=new j(j.nOFF,"OFF");j.FATAL=new j(j.nFATAL,"FATAL");j.ERROR=new j(j.nERROR,"ERROR");j.WARNING=new j(j.nWARNING,"WARN");j.INFO=new j(j.nINFO,"INFO");j.DEBUG=new j(j.nDEBUG,"DEBUG");j.TRACE=new j(j.nTRACE,"TRACE");j.ALL=new j(j.nALL,"ALL");f=function(v){e.apply(this,[j.TRACE,"Trace Message",v])};f.prototype=new e();a=function(v,w,x){this.sIndentString="";this.oConstructor=v;this.sMethodName=w;this.oTracer=x};a.prototype.formatArguments=function(v){return"("+v.join(", ")+")"};a.prototype.getIndentation=function(){return this.sIndentString};a.prototype.getMethodNameIndentedAndParams=function(v){return(this.getIndentation()+this.sMethodName+this.formatArguments(v))};a.prototype.getProfile=function(w,v){return this.getIndentation(true)+this.sMethodName+" -> result: "+v+". ("+(+new Date()-w)+"ms)"};a.prototype.wrap=function(){var v="";for(v in this.oConstructor){this[v]=this.oConstructor[v]}};p=function(){this.rNativeCode=/\[native code\]/;this.nIndentCount=-4;this.aTracing=[]};p.prototype.trace=function(w,x){var v=new a(w,x,this);v.wrap();o.addError(new f("Tracing: "+x));return function(){var y=null,z=+new Date(),A=Array.prototype.slice.call(arguments);o.addError(new f(v.getMethodNameIndentedAndParams(A)));y=w.apply(v,arguments);o.addError(new f(v.getProfile(z,y)));return y}};p.prototype.addTracing=function(v){this.aTracing.push(v)};p.prototype.traceAll=function(v,y){var w="";var x=null;if((v===h)||!((typeof v==="object"))||(typeof v==="function")){return}for(w in v){if(v[w]!==v){x=v[w];if(typeof x==="function"){if((this!==v)&&!x.oConstructor&&!this.rNativeCode.test(x)){v[w]=this.trace(v[w],w);this.addTracing({oObj:v,sMethodName:w})}}y&&this.traceAll(x,true)}}};p.prototype.resetTracing=function(){this.aTracking=[]};p.prototype.untraceAll=function(){var x=0;var w=this.aTracing;var y=w.length;var v=null;for(;x<y;x++){v=w[x];v.oObj[v.sMethodName]=v.oObj[v.sMethodName].oConstructor}o.addError(new f("Tracing disabled"));this.resetTracing()};o=new g(j.ALL,g.IMMEDIATE).addAppender(new k());h.onerror=function s(w,v,x){o.addError(new e(o.oLevel,l(w),i(w),v,x));return false};h.Hermes={logger:o,appender:u,level:j,error:e,layout:r,tracer:new p()}}(window));

			//Change the log to be deferred.
			Hermes.logger.immediateLog();
			Hermes.logger.setLevel(Hermes.level.ALL);

			//Add new Error
			Hermes.logger.addError( new Hermes.error( Hermes.level.DEBUG, "1__Special Error", "What a message1!", "", "" ) );
			//Add new Error
			Hermes.logger.addError( new Hermes.error( Hermes.level.DEBUG, "2__Special Error", "What a message2!", "", "" ) );

			//The uncaught errors are logged too.
			throw new Error("Test error message");